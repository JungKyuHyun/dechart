{"version":3,"sources":["AreaChart/areaChartEvents.ts"],"names":["AreaChart","prototype","attachEventHandlers","that","svgRootInnerNode","$svgRootInner","node","$svgRoot","on","$bulb","style","emit","syntheticEvent","makeSyntheticEvent","handleMousemoveForBulb","undefined","mouseCoord","d3","mouse","xVal","xScale","invert","_xIdx","data","values","xIdx","length","selectedData","bulbX","date","bulbY","yScale","SyntheticEvent","clientX","clientY","select","attr","d","yMax"],"mappings":"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","sourcesContent":["import * as d3 from 'd3';\nimport {\n  makeBisector,\n  valueSum,\n} from '../utils';\nimport SyntheticEvent from '../SyntheticEvent';\n\nexport default function (AreaChart) {\n  AreaChart.prototype.attachEventHandlers = function () {\n    const that = this;\n    const svgRootInnerNode = that.$svgRootInner && that.$svgRootInner.node();\n\n    that.$svgRoot\n      .on('mouseover', () => {\n        that.$bulb.style('display', null);\n        that.emit('mouseover', {});\n      })\n\n      .on('mouseout', () => {\n        that.$bulb.style('display', 'none');\n        that.emit('mouseout', {});\n      })\n\n      .on('mousemove', () => {\n        const syntheticEvent = makeSyntheticEvent(that, svgRootInnerNode);\n        handleMousemoveForBulb(that, syntheticEvent);\n        that.emit('mousemove', syntheticEvent);\n      });\n  };\n  return AreaChart;\n}\n\nfunction makeSyntheticEvent(that, svgRootInnerNode) {\n  if (svgRootInnerNode === undefined) return;\n\n  const mouseCoord = d3.mouse(svgRootInnerNode);\n  const xVal = that.xScale.invert(mouseCoord[0]);\n  const _xIdx = makeBisector('date')(that.data.values, xVal);\n  const xIdx = _xIdx >= that.data.values.length ? that.data.values.length - 1 : _xIdx;\n  const selectedData = that.data.values[xIdx];\n  const bulbX = [ that.xScale(selectedData.date) ];\n  const bulbY = [ that.yScale(valueSum(selectedData)) ];\n\n  return new SyntheticEvent({\n    bulbX,\n    bulbY,\n    clientX: mouseCoord[0],\n    clientY: mouseCoord[1],\n    selectedData,\n    xIdx,\n  });\n}\n\nfunction handleMousemoveForBulb(that, syntheticEvent) {\n  const {\n bulbX, bulbY, data \n} = syntheticEvent;\n\n  that.$bulb.select('.x-hover-line')\n    .attr('y2', (d) => {\n      return that.yScale(that.yMax - valueSum(data));\n    });\n\n  that.$bulb.select('.y-hover-line')\n    .attr('x2', (d) => {\n      return -bulbX[0];\n    });\n\n  that.$bulb\n    .attr('transform', (d) => (\n      `translate(${bulbX[0]}, ${bulbY[0]})`\n    ));\n}\n"],"file":"areaChartEvents.js"}